<!-- src/main/resources/templates/subir-fotos.html -->
<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subir Fotos – Fotógrafo Profesional</title>
  <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
<!-- Navbar -->
<div th:replace="navbar :: navbar"></div>
<div th:replace="fragments/scripts :: script"></div>

<!-- Sección principal: formularios de evento, álbum y subida de fotos -->
<section class="upload-section">
  <div class="upload-card">
    <h2>Crear nuevo evento</h2>
    <form id="createEventForm">
      <label for="eventName">Nombre del evento:</label>
      <input type="text" id="eventName" required />
      <label for="eventDate">Fecha del evento:</label>
      <input type="date" id="eventDate" required
             th:max="${#dates.format(#dates.createNow(),'yyyy-MM-dd')}" 
             max="[[${#dates.format(#dates.createNow(),'yyyy-MM-dd')}]]" />
      <label for="eventLocation">Lugar del evento:</label>
      <input type="text" id="eventLocation" required />
      <label for="eventCategory">Categoría del evento:</label>
      <select id="eventCategory" required>
        <option value="">-- Selecciona una categoría --</option>
        <option value="Bodas">Bodas</option>
        <option value="Bautizos">Bautizos</option>
        <option value="Comuniones">Comuniones</option>
        <option value="Retratos">Retratos</option>
        <option value="Conciertos">Conciertos</option>
      </select>
      <label for="eventClientId">Seleccionar cliente:</label>
      <select id="eventClientId" required>
        <option value="">-- Selecciona un cliente --</option>
      </select>
      <label for="eventPrivado">
        <input type="checkbox" id="eventPrivado" checked /> Privado (solo el cliente podrá ver el evento)
      </label>
      <button type="submit" id="createEventBtn">Crear evento</button>
    </form>
    <div id="eventMessage"></div>
  </div>
  <div class="upload-card">
    <h2>Crear nuevo álbum</h2>
    <form id="createAlbumForm">
      <label for="newAlbum">Nombre del álbum:</label>
      <input type="text" id="newAlbum" required />
      <label for="eventSelect">Seleccionar evento:</label>
      <select id="eventSelect" required></select>
      <button type="submit" id="createAlbumBtn">Crear álbum</button>
    </form>
    <div id="albumMessage"></div>
  </div>
  <div class="upload-card">
    <h2>Subir fotos al álbum</h2>
    <form id="uploadForm" enctype="multipart/form-data">
      <label for="albumSelect">Seleccionar álbum:</label>
      <select id="albumSelect" required></select>
      <input type="hidden" id="uploadAlbumId" />
      <label for="files">Selecciona las fotos:</label>
      <input type="file" id="files" name="files" multiple accept="image/*" required />
      <button type="submit">Subir fotos</button>
    </form>
    <div id="uploadStatus"></div>
  </div>
</section>

<!-- Scripts -->
<script th:src="@{/js/visualizar-albumes.js}"></script>
<script th:src="@{/js/script.js}"></script>

<!-- Footer -->
<footer>
  <div class="footer-social">
    <a href="https://instagram.com/clicycolor" aria-label="Instagram" target="_blank">
      <img src="/img/instagram.png" alt="Instagram" class="social-icon" />
    </a>
    <a href="https://wa.me/0034603109882" aria-label="WhatsApp" target="_blank">
      <img src="/img/whatsapp.png" alt="WhatsApp" class="social-icon" />
    </a>
  </div>
  <div class="footer-content">
    <p>&copy; 2025 Clic y Color. Todos los derechos reservados.</p>
    <a href="#" id="terms-link" class="terms-link">Términos y Condiciones</a>
  </div>
</footer>

<div id="terms" class="terms-container" style="display:none;">
  <div id="terms-content">
    <!-- El contenido de los términos se cargará aquí -->
  </div>
  <button id="close-terms-btn" onclick="document.getElementById('terms').style.display='none'">Cerrar</button>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Términos y condiciones modal
    var termsLink = document.getElementById('terms-link');
    var termsModal = document.getElementById('terms');
    var closeBtn = document.getElementById('close-terms-btn');
    var termsContent = document.getElementById('terms-content');

    if (termsLink && termsModal) {
      termsLink.addEventListener('click', function(e) {
        e.preventDefault();
        fetch('/terminos-condiciones.html')
          .then(response => response.text())
          .then(data => {
            termsContent.innerHTML = data;
            termsModal.style.display = 'block';
          })
          .catch(error => {
            console.error('Error al cargar los términos y condiciones:', error);
          });
      });
    }
    if (closeBtn && termsModal) {
      closeBtn.addEventListener('click', function() {
        termsModal.style.display = 'none';
      });
    }

    // Forzar el atributo max en el input de fecha (por si el navegador o un datepicker externo no lo respeta)
    var dateInput = document.getElementById('eventDate');
    if (dateInput) {
      var today = new Date().toISOString().split('T')[0];
      dateInput.setAttribute('max', today);
    }

    // Si usas un datepicker externo, configura aquí el máximo (ejemplo para flatpickr)
    if (window.flatpickr) {
      flatpickr("#eventDate", {
        maxDate: "today",
        dateFormat: "Y-m-d"
      });
    }
    // Ejemplo para bootstrap-datepicker:
    // if (window.jQuery && $('#eventDate').datepicker) {
    //   $('#eventDate').datepicker({ endDate: today, format: 'yyyy-mm-dd' });
    // }
  });
</script>

<div id="notification" style="display:none;position:fixed;bottom:2rem;right:2rem;z-index:9999;background:#222;color:#fff;padding:1rem 2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.15);"></div>
</body>
</html>

<script>
  // Suponiendo que este script está relacionado con el formulario de creación de eventos
  document.getElementById('createEventForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Evita el envío del formulario

    const form = event.target;
    const eventId = form.eventSelect.value;
    const date = form.eventDate.value;
    const loc = form.eventLocation.value.trim();
    const category = form.eventCategory.value;
    const client = form.eventClientId.value.trim() || null;

    // Aquí iría el código para manejar el envío de datos, por ejemplo, una llamada a la API
    console.log({ eventId, date, loc, category, client });
  });
</script>