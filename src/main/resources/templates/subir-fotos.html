<!-- src/main/resources/templates/subir-fotos.html -->
<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Subir Fotos – Fotógrafo Profesional</title>
  <link rel="stylesheet" th:href="@{/css/style.css}" />
</head>
<body>
<!-- Navbar -->
<div th:replace="~{navbar :: navbar}"></div>
<div th:replace="~{fragments/scripts :: script}"></div>

<!-- Sección principal: formularios de evento, álbum y subida de fotos -->
<section class="upload-section">
  <div class="upload-card">
    <h2>Crear nuevo evento</h2>
    <form id="createEventForm">
      <label for="eventName">Nombre del evento:</label>
      <input type="text" id="eventName" required />
      <label for="eventDate">Fecha del evento:</label>
      <input type="date" id="eventDate" required
             th:max="${#dates.format(#dates.createNow(),'yyyy-MM-dd')}" 
             max="[[${#dates.format(#dates.createNow(),'yyyy-MM-dd')}]]" />
      <label for="eventLocation">Lugar del evento:</label>
      <input type="text" id="eventLocation" required />
      <label for="eventCategory">Categoría del evento:</label>
      <select id="eventCategory" required>
        <option value="">-- Selecciona una categoría --</option>
        <option value="Bodas">Bodas</option>
        <option value="Bautizos">Bautizos</option>
        <option value="Comuniones">Comuniones</option>
        <option value="Retratos">Retratos</option>
        <option value="Conciertos">Conciertos</option>
      </select>
      <label for="eventClientId">Seleccionar cliente:</label>
      <select id="eventClientId" required>
        <option value="">-- Selecciona un cliente --</option>
      </select>
      <label for="eventPrivado">
        <input type="checkbox" id="eventPrivado" checked /> Privado (solo el cliente podrá ver el evento)
      </label>
      <!-- Input para portada del evento -->
      <label for="eventCover">Selecciona la foto de portada del evento:</label>
      <input type="file" id="eventCover" name="eventCover" accept="image/*" />
      <div style="margin:1rem 0; text-align:center;">
        <img id="eventCoverPreview"
             src="/img/default-event.jpg"
             alt="Imagen destacada del evento"
             style="max-width:120px; max-height:120px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08); display:block; margin:auto;" />
      </div>
      <button type="submit" id="createEventBtn">Crear evento</button>
    </form>
    <div id="eventMessage"></div>
  </div>
  <div class="upload-card">
    <h2>Crear nuevo álbum</h2>
    <form id="createAlbumForm" enctype="multipart/form-data">
      <label for="newAlbum">Nombre del álbum:</label>
      <input type="text" id="newAlbum" required />
      <label for="eventSelect">Seleccionar evento:</label>
      <select id="eventSelect" required></select>
      <label for="albumCover">Selecciona la foto de portada del álbum:</label>
      <input type="file" id="albumCover" name="albumCover" accept="image/*" />
      <div style="margin:1rem 0; text-align:center;">
        <img id="albumCoverPreview" src="/img/default-event.jpg" alt="Imagen de álbum" style="max-width:120px; max-height:120px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.08); display:block; margin:auto;" />
      </div>
      <button type="submit" id="createAlbumBtn">Crear álbum</button>
    </form>
    <div id="albumMessage"></div>
  </div>
  <div class="upload-card">
    <h2>Subir fotos al álbum</h2>
    <form id="uploadForm" enctype="multipart/form-data">
      <label for="albumSelect">Seleccionar álbum:</label>
      <select id="albumSelect" required></select>
      <input type="hidden" id="uploadAlbumId" />
      <label for="files">Selecciona las fotos:</label>
      <input type="file" id="files" name="files" multiple accept="image/*" required />
      <button type="submit">Subir fotos</button>
    </form>
    <div id="uploadStatus"></div>
  </div>
</section>

<!-- Scripts -->
<script th:src="@{/js/visualizar-albumes.js}"></script>
<script th:src="@{/js/script.js}"></script>

<!-- Footer -->
<footer>
  <div class="footer-social">
    <a href="https://instagram.com/clicycolor" aria-label="Instagram" target="_blank">
      <img src="/img/instagram.png" alt="Instagram" class="social-icon" />
    </a>
    <a href="https://wa.me/0034603109882" aria-label="WhatsApp" target="_blank">
      <img src="/img/whatsapp.png" alt="WhatsApp" class="social-icon" />
    </a>
  </div>
  <div class="footer-content">
    <p>&copy; 2025 Clic y Color. Todos los derechos reservados.</p>
    <a href="#" id="terms-link" class="terms-link">Términos y Condiciones</a>
  </div>
</footer>

<div id="terms" class="terms-container" style="display:none;">
  <div id="terms-content">
    <!-- El contenido de los términos se cargará aquí -->
  </div>
  <button id="close-terms-btn" onclick="document.getElementById('terms').style.display='none'">Cerrar</button>
</div>
<div id="notification" style="display:none;position:fixed;bottom:2rem;right:2rem;z-index:9999;background:#222;color:#fff;padding:1rem 2rem;border-radius:8px;box-shadow:0 2px 8px rgba(0,0,0,0.15);"></div>
</body>
</html>

<script>
  // Suponiendo que este script está relacionado con el formulario de creación de eventos
  document.getElementById('createEventForm').addEventListener('submit', function(event) {
    event.preventDefault(); // Evita el envío del formulario

    const form = event.target;
    const eventId = form.eventSelect.value;
    const date = form.eventDate.value;
    const loc = form.eventLocation.value.trim();
    const category = form.eventCategory.value;
    const client = form.eventClientId.value.trim() || null;

    // Aquí iría el código para manejar el envío de datos, por ejemplo, una llamada a la API
    console.log({ eventId, date, loc, category, client });
  });

  // Previsualización de la portada del álbum
  document.getElementById('albumCover').addEventListener('change', function(e) {
    const preview = document.getElementById('albumCoverPreview');
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(ev) {
        preview.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    } else {
      preview.src = '/img/default-event.jpg';
    }
  });

  // Previsualización de la portada del evento
  document.getElementById('eventCover').addEventListener('change', function(e) {
    const preview = document.getElementById('eventCoverPreview');
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(ev) {
        preview.src = ev.target.result;
      };
      reader.readAsDataURL(file);
    } else {
      preview.src = '/img/default-event.jpg';
    }
  });
</script>